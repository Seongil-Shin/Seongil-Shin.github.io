<!DOCTYPE html><html lang="ko" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="유닛테스트 구현 검증이란?" /><meta name="author" content="신성일" /><meta property="og:locale" content="ko" /><meta name="description" content="비즈니스 코드를 먼저 작성하고 유닛테스트를 작성할 때, 완성된 코드를 보고 테스트 코드를 작성하다보면 내부 구현에 맞추어 테스트를 작성하게 되고, 구현 자체를 검증하게 되는 일이 많이 발생하였다." /><meta property="og:description" content="비즈니스 코드를 먼저 작성하고 유닛테스트를 작성할 때, 완성된 코드를 보고 테스트 코드를 작성하다보면 내부 구현에 맞추어 테스트를 작성하게 되고, 구현 자체를 검증하게 되는 일이 많이 발생하였다." /><link rel="canonical" href="https://seongil-shin.github.io/posts/design-pattern-%EC%9C%A0%EB%8B%9B%ED%85%8C%EC%8A%A4%ED%8A%B8%EC%97%90%EC%84%9C-%EA%B5%AC%ED%98%84-%EA%B2%80%EC%A6%9D%EC%9D%B4%EB%9E%80/" /><meta property="og:url" content="https://seongil-shin.github.io/posts/design-pattern-%EC%9C%A0%EB%8B%9B%ED%85%8C%EC%8A%A4%ED%8A%B8%EC%97%90%EC%84%9C-%EA%B5%AC%ED%98%84-%EA%B2%80%EC%A6%9D%EC%9D%B4%EB%9E%80/" /><meta property="og:site_name" content="디피의 개발일지" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-11-09T18:19:26+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="유닛테스트 구현 검증이란?" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"신성일"},"dateModified":"2023-05-30T23:05:25+09:00","datePublished":"2022-11-09T18:19:26+09:00","description":"비즈니스 코드를 먼저 작성하고 유닛테스트를 작성할 때, 완성된 코드를 보고 테스트 코드를 작성하다보면 내부 구현에 맞추어 테스트를 작성하게 되고, 구현 자체를 검증하게 되는 일이 많이 발생하였다.","headline":"유닛테스트 구현 검증이란?","mainEntityOfPage":{"@type":"WebPage","@id":"https://seongil-shin.github.io/posts/design-pattern-%EC%9C%A0%EB%8B%9B%ED%85%8C%EC%8A%A4%ED%8A%B8%EC%97%90%EC%84%9C-%EA%B5%AC%ED%98%84-%EA%B2%80%EC%A6%9D%EC%9D%B4%EB%9E%80/"},"url":"https://seongil-shin.github.io/posts/design-pattern-%EC%9C%A0%EB%8B%9B%ED%85%8C%EC%8A%A4%ED%8A%B8%EC%97%90%EC%84%9C-%EA%B5%AC%ED%98%84-%EA%B2%80%EC%A6%9D%EC%9D%B4%EB%9E%80/"}</script><title>유닛테스트 구현 검증이란? | 디피의 개발일지</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-HC9W0NGRV0"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-HC9W0NGRV0'); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/profile.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">디피의 개발일지</a></div><div class="site-subtitle font-italic">개인 학습 및 프로젝트 기록</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/Seongil-Shin" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['callmeshin75','gmail.com'].join('@')" aria-label="email" class="order-4" > <i class="fas fa-envelope"></i> </a> <a href="https://www.linkedin.com/in/%EC%84%B1%EC%9D%BC-%EC%8B%A0-a9411b237/" aria-label="linkedin" class="order-5" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>유닛테스트 구현 검증이란?</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>유닛테스트 구현 검증이란?</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> 신성일 </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Wed, Nov 9, 2022, 6:19 PM +0900" prep="on" > Nov 9, 2022 <i class="unloaded">2022-11-09T18:19:26+09:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Tue, May 30, 2023, 11:05 PM +0900" prefix="Updated " > May 30, 2023 <i class="unloaded">2023-05-30T23:05:25+09:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="4447 words">24 min</span></div></div><div class="post-content"><p>비즈니스 코드를 먼저 작성하고 유닛테스트를 작성할 때, 완성된 코드를 보고 테스트 코드를 작성하다보면 내부 구현에 맞추어 테스트를 작성하게 되고, 구현 자체를 검증하게 되는 일이 많이 발생하였다.</p><p><strong>유닛 테스트에서는 구현이 아닌 행동을 검증</strong>(test behaviour, not implementation)해야한다. 따라서 구현을 검증한 테스트 코드를 고치려 했으나 어디까지가 구현을 검증한 것인지가 모호했다.</p><blockquote><p>A 메서드 안에서 B 메서드를 제대로 호출했는지를 보는 것도 구현 검증일까?</p><p>구현 검증을 피하고자 DB를 검사해도 되는 걸까?</p><p>최종 결과물을 내지 않는 void 메서드는 어떻게 테스트하지?</p></blockquote><p>명확한 기준을 세우고 싶어 여러모로 조사하였다.</p><p><br /></p><h2 id="구현을-검증하는-경우"><strong>구현을 검증하는 경우</strong></h2><p>아래 내용은 <a href="https://jojoldu.tistory.com/614">유닛테스트에서 내부구현 검증 피하기</a>라는 포스트에서 가져온 내용으로, 구현 검증이 무엇인지 이해하기 위해 살펴봤다.</p><h3 id="상세-구현부를-다-검증하는-경우"><strong>상세 구현부를 다 검증하는 경우</strong></h3><p>다음과 같은 클래스가 있다</p><div class="language-javascript highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="k">export</span> <span class="kd">class</span> <span class="nc">OrderAmountSum</span> <span class="p">{</span>
   <span class="nl">minusSum</span><span class="p">:</span> <span class="nx">number</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
   <span class="nl">plusSum</span><span class="p">:</span> <span class="nx">number</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

   <span class="nf">constructor</span><span class="p">(</span><span class="nx">amounts</span><span class="p">:</span> <span class="nx">number</span><span class="p">[])</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nf">addPlusAmounts</span><span class="p">(</span><span class="nx">amounts</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nf">addMinusAmounts</span><span class="p">(</span><span class="nx">amounts</span><span class="p">);</span>
   <span class="p">}</span>

   <span class="kd">get</span> <span class="nf">sumAmount</span><span class="p">():</span> <span class="nx">number</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">plusSum</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">minusSum</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="nf">addPlusAmounts</span><span class="p">(</span><span class="nx">amounts</span><span class="p">:</span> <span class="nx">number</span><span class="p">[]):</span> <span class="k">void</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">plusSum</span> <span class="o">=</span> <span class="nx">amounts</span>
         <span class="p">.</span><span class="nf">filter</span><span class="p">((</span><span class="nx">amount</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">amount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
         <span class="p">.</span><span class="nf">reduce</span><span class="p">((</span><span class="nx">before</span><span class="p">,</span> <span class="nx">current</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">before</span> <span class="o">+</span> <span class="nx">current</span><span class="p">);</span>
   <span class="p">}</span>

   <span class="nf">addMinusAmounts</span><span class="p">(</span><span class="nx">amounts</span><span class="p">:</span> <span class="nx">number</span><span class="p">[]):</span> <span class="k">void</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">minusSum</span> <span class="o">=</span> <span class="nx">amounts</span>
         <span class="p">.</span><span class="nf">filter</span><span class="p">((</span><span class="nx">amount</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">amount</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
         <span class="p">.</span><span class="nf">reduce</span><span class="p">((</span><span class="nx">before</span><span class="p">,</span> <span class="nx">current</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">before</span> <span class="o">+</span> <span class="nx">current</span><span class="p">);</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>이 클래스에서 중요한 비즈니스 로직은 <code class="language-plaintext highlighter-rouge">sumAmount</code>에 있다. <code class="language-plaintext highlighter-rouge">addPlusAmounts</code>, <code class="language-plaintext highlighter-rouge">addMinusAmounts</code>은 부차적인 기능에 불과하다. 하지만 여기서 다음과 같이 부차적인 기능에 대한 테스트를 짜는 실수를 할 수 있다.</p><div class="language-javascript highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="nf">it</span><span class="p">(</span><span class="dl">"</span><span class="s2">plusSum에는 양수들의 총합이 등록된다</span><span class="dl">"</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
   <span class="kd">const</span> <span class="nx">sut</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">OrderAmountSum</span><span class="p">([</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="mi">500</span><span class="p">]);</span>

   <span class="nf">expect</span><span class="p">(</span><span class="nx">sut</span><span class="p">.</span><span class="nx">plusSum</span><span class="p">).</span><span class="nf">toBe</span><span class="p">(</span><span class="mi">1300</span><span class="p">);</span>
<span class="p">});</span>

<span class="nf">it</span><span class="p">(</span><span class="dl">"</span><span class="s2">minusSum에는 음수들의 총합이 등록된다</span><span class="dl">"</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
   <span class="kd">const</span> <span class="nx">sut</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">OrderAmountSum</span><span class="p">([</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="mi">500</span><span class="p">]);</span>

   <span class="nf">expect</span><span class="p">(</span><span class="nx">sut</span><span class="p">.</span><span class="nx">minusSum</span><span class="p">).</span><span class="nf">toBe</span><span class="p">(</span><span class="o">-</span><span class="mi">600</span><span class="p">);</span>
<span class="p">});</span>

<span class="nf">it</span><span class="p">(</span><span class="dl">"</span><span class="s2">전체 합계 금액을 구한다</span><span class="dl">"</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
   <span class="kd">const</span> <span class="nx">sut</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">OrderAmountSum</span><span class="p">([</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="mi">500</span><span class="p">]);</span>

   <span class="nf">expect</span><span class="p">(</span><span class="nx">sut</span><span class="p">.</span><span class="nx">sumAmount</span><span class="p">).</span><span class="nf">toBe</span><span class="p">(</span><span class="mi">700</span><span class="p">);</span>
<span class="p">});</span>
</pre></table></code></div></div><p>이렇게 되면 만약 다음과 같이 코드가 변경되었을 경우 <code class="language-plaintext highlighter-rouge">sumAmount</code> 테스트 말고는 전부 깨질 것이다.</p><div class="language-javascript highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="k">export</span> <span class="kd">class</span> <span class="nc">OrderAmountSum2</span> <span class="p">{</span>
   <span class="nl">amounts</span><span class="p">:</span> <span class="nx">number</span><span class="p">[];</span>

   <span class="nf">constructor</span><span class="p">(</span><span class="nx">amounts</span><span class="p">:</span> <span class="nx">number</span><span class="p">[])</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">amounts</span> <span class="o">=</span> <span class="nx">amounts</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="kd">get</span> <span class="nf">sumAmount</span><span class="p">():</span> <span class="nx">number</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">amounts</span><span class="p">.</span><span class="nf">reduce</span><span class="p">((</span><span class="nx">before</span><span class="p">,</span> <span class="nx">current</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">before</span> <span class="o">+</span> <span class="nx">current</span><span class="p">);</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>핵심 로직이 아닌 부차적인 기능까지 테스트하여 발생한 문제다. 따라서 <code class="language-plaintext highlighter-rouge">OrderAmountSum</code>의 테스트 코드는 다음과 같이 작성되어야한다.</p><div class="language-javascript highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="nf">describe</span><span class="p">(</span><span class="dl">"</span><span class="s2">OrderAmountSum2</span><span class="dl">"</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
   <span class="nf">it</span><span class="p">(</span><span class="dl">"</span><span class="s2">전체 합계 금액을 구한다</span><span class="dl">"</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">sut</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">OrderAmountSum2</span><span class="p">([</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="mi">500</span><span class="p">]);</span>

      <span class="nf">expect</span><span class="p">(</span><span class="nx">sut</span><span class="p">.</span><span class="nx">sumAmount</span><span class="p">).</span><span class="nf">toBe</span><span class="p">(</span><span class="mi">700</span><span class="p">);</span>
   <span class="p">});</span>

   <span class="nf">it</span><span class="p">(</span><span class="dl">"</span><span class="s2">-금액들의 합계 금액을 구한다</span><span class="dl">"</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">sut</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">OrderAmountSum2</span><span class="p">([</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="o">-</span><span class="mi">300</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="mi">500</span><span class="p">]);</span>

      <span class="nf">expect</span><span class="p">(</span><span class="nx">sut</span><span class="p">.</span><span class="nx">sumAmount</span><span class="p">).</span><span class="nf">toBe</span><span class="p">(</span><span class="o">-</span><span class="mi">1900</span><span class="p">);</span>
   <span class="p">});</span>
<span class="p">});</span>
</pre></table></code></div></div><p><br /></p><h3 id="모의-객체-행위-검증하기"><strong>모의 객체 행위 검증하기</strong></h3><p>다음과 같이 Order를 업데이트하거나 생성하는 메소드가 있다고 해보자.</p><div class="language-javascript highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="k">export</span> <span class="kd">class</span> <span class="nc">OrderService</span> <span class="p">{</span>
    <span class="nf">constructor</span><span class="p">(</span><span class="kr">private</span> <span class="nx">readonly</span> <span class="nx">orderRepository</span><span class="p">:</span> <span class="nx">OrderRepository</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">}</span>

    <span class="nf">saveOrUpdate</span><span class="p">(</span><span class="nx">order</span><span class="p">:</span> <span class="nx">Order</span><span class="p">):</span> <span class="k">void</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">savedOrder</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">orderRepository</span><span class="p">.</span><span class="nf">findById</span><span class="p">(</span><span class="nx">order</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
        <span class="k">if </span><span class="p">(</span><span class="nx">savedOrder</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">orderRepository</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="nx">order</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">orderRepository</span><span class="p">.</span><span class="nf">save</span><span class="p">(</span><span class="nx">order</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>이때 stub을 통한 모의 객체를 사용하여 다음과 같은 테스트를 작성할 수 있다.</p><div class="language-javascript highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="nf">it</span><span class="p">(</span><span class="dl">"</span><span class="s2">기존 주문이 있으면 새 정보로 갱신된다</span><span class="dl">"</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
   <span class="kd">const</span> <span class="nx">savedOrder</span> <span class="o">=</span> <span class="nx">Order</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="nx">LocalDateTime</span><span class="p">.</span><span class="nf">now</span><span class="p">(),</span> <span class="dl">""</span><span class="p">);</span>
   <span class="nf">when</span><span class="p">(</span><span class="nx">mockedRepository</span><span class="p">.</span><span class="nf">findById</span><span class="p">(</span><span class="nf">anyNumber</span><span class="p">())).</span><span class="nf">thenReturn</span><span class="p">(</span><span class="nx">savedOrder</span><span class="p">);</span>
   <span class="kd">const</span> <span class="nx">sut</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">OrderService</span><span class="p">(</span><span class="nf">instance</span><span class="p">(</span><span class="nx">mockedRepository</span><span class="p">));</span>

   <span class="nx">sut</span><span class="p">.</span><span class="nf">saveOrUpdate</span><span class="p">(</span><span class="nf">createOrder</span><span class="p">(</span><span class="nx">savedOrder</span><span class="p">,</span> <span class="mi">200</span><span class="p">));</span>

   <span class="nf">verify</span><span class="p">(</span><span class="nx">mockedRepository</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="nf">anything</span><span class="p">())).</span><span class="nf">called</span><span class="p">();</span>
<span class="p">});</span>
</pre></table></code></div></div><p>여기서의 문제는 <code class="language-plaintext highlighter-rouge">saveOrUpdate</code> 내부에서 <strong>repository를 하나하나 어떻게 쓰는지 검증</strong>했다는 점이다. 만약 다음과 같이 <code class="language-plaintext highlighter-rouge">saveOrUpdate</code>가 변경된다면 어떻게 될까?</p><div class="language-javascript highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nf">saveOrUpdate</span><span class="p">(</span><span class="nx">order</span><span class="p">:</span> <span class="nx">Order</span><span class="p">):</span> <span class="k">void</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">orderRepository</span><span class="p">.</span><span class="nf">saveOrUpdate</span><span class="p">(</span><span class="nx">order</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>실제로는 잘 저장 또는 업데이트 되어도 테스트는 실패했다고 뜰 것이다. 따라서 테스트는 다음과 같이 진행되어야한다.</p><div class="language-javascript highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="nf">it</span><span class="p">(</span><span class="dl">"</span><span class="s2">[After] 기존 주문이 있으면 새 정보로 갱신된다</span><span class="dl">"</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
   <span class="kd">const</span> <span class="nx">savedOrder</span> <span class="o">=</span> <span class="nx">realRepository</span><span class="p">.</span><span class="nf">save</span><span class="p">(</span>
      <span class="nx">Order</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="nx">LocalDateTime</span><span class="p">.</span><span class="nf">now</span><span class="p">(),</span> <span class="dl">""</span><span class="p">)</span>
   <span class="p">);</span>
   <span class="kd">const</span> <span class="nx">expectAmount</span> <span class="o">=</span> <span class="mi">200</span><span class="p">;</span>

   <span class="kd">const</span> <span class="nx">sut</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">OrderService</span><span class="p">(</span><span class="nx">realRepository</span><span class="p">);</span>
   <span class="nx">sut</span><span class="p">.</span><span class="nf">saveOrUpdate2</span><span class="p">(</span><span class="nf">createOrder</span><span class="p">(</span><span class="nx">savedOrder</span><span class="p">,</span> <span class="nx">expectAmount</span><span class="p">));</span>

   <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">realRepository</span><span class="p">.</span><span class="nf">findById</span><span class="p">(</span><span class="nx">savedOrder</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>

   <span class="nf">expect</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">amount</span><span class="p">).</span><span class="nf">toBe</span><span class="p">(</span><span class="nx">expectAmount</span><span class="p">);</span>
<span class="p">});</span>
</pre></table></code></div></div><p><br /></p><h2 id="의문-하나씩-살펴보기"><strong>의문 하나씩 살펴보기</strong></h2><p>위에서 살펴본 경우를 보고 한번 글 초반에 작성했던 의문에 대한 답을 생각해보자</p><h3 id="a-메서드-안에서-b-메서드를-제대로-호출했는지를-보는-것도-구현-검증일까">A 메서드 안에서 B 메서드를 제대로 호출했는지를 보는 것도 구현 검증일까?</h3><p>구현 검증이다. A 메서드는 B 메서드를 호출하든 안하든 A 메서드에 부여된 일을 수행하면 될 뿐이다.</p><p>만약 구현이 변경되어 A메서드는 B 메서드가 아닌 C 메서드를 호출하는 것으로 변경되었으나 기능은 기존과 동일할때, B 메서드에 의존한 테스트는 실패하게 된다. 이는 위 예시로 봤을 때 구현 검증으로 테스트가 깨진 사례에 속한다.</p><h3 id="구현-검증을-피하고자-db를-검사해도-되는-걸까"><strong>구현 검증을 피하고자 DB를 검사해도 되는 걸까?</strong></h3><p>좋지 않은 패턴이다. DB에 의존하여 결과를 확인하는 것은 DB의 상태, 버전 등에 따라 테스트 결과가 달라질 수도 있다. 매번 결과가 다른 테스트가 작성되는 것이고, 이는 테스트의 <code class="language-plaintext highlighter-rouge">F.I.R.S.T</code> 원칙의 <code class="language-plaintext highlighter-rouge">Repeatable</code> 을 위반한 사례이다.</p><h3 id="최종-결과물을-내지-않는-void-메서드는-어떻게-테스트하지"><strong>최종 결과물을 내지 않는 void 메서드는 어떻게 테스트하지?</strong></h3><p>구현이 아닌 행동를 테스트해야하는 건 잘 알았다. 하지만 결과를 쉽게 알 수 없는 void 메서드일 경우는 어떻게 테스트 해야할까?</p><p>테스트 코드 작성 경험이 별로 없는 나에겐 빠르게 생각하기 어려웠다. 따라서 한번 관련 글들을 조사해보았다.</p><p><br /></p><h2 id="test-behaviour-not-implementation"><strong>Test behaviour, not implementation</strong></h2><p><code class="language-plaintext highlighter-rouge">Test behaviour, not implementation</code>이라고 검색한 후 나온 포스트들을 하나씩 보며 구현을 검증하지 않고 행동을 검증하는 것이 무엇인지를 알아보았다</p><h3 id="testing-behavior-vs-testing-implementation"><strong><a href="https://launchscout.com/blog/testing-behavior-vs-testing-implementation">Testing Behavior vs. Testing Implementation</a></strong></h3><p><strong>Testing Behavior</strong> : 정답이 왜 나오는 지는 모르겠는데, 이 환경에서 이 결과만 나오면 돼!</p><p><strong>Testing Implementation</strong> : 결과는 신경안쓰고, 과정만 제대로 확인해!</p><p>실제로는 결과를 보며 테스트를 하지만, 너무 많은 mock와 stub에 의존하며 결과가 어떻게 나오는지에 대한 많은 assertions을 만들게 된다. 이러한 mocks와 stub은 시스템이 발전함에 따라 문제가 된다.</p><p>mocks와 stub가 나쁜 것은 아니다. mocks와 stub은 서로 다른 시나리오와 환경에서 테스트를 할 수 있게 해준다. 이 정도는 <code class="language-plaintext highlighter-rouge">supporting implementation</code>이며 <code class="language-plaintext highlighter-rouge">testing implementation</code>이 아니다. 하지만 너무 많은 assertions이 mocks와 stub에 의존하여 나온다면 문제가 된다.</p><p><strong>Testing behavior와 testing implementation이 같아지는 때</strong>가 있다. 테스트하는 메서드가 coordinator 메서드일 경우 그렇다. 이러한 메서드는 결정을 내리고 다른 메서드나 클래스를 호출하는 역할을 한다. 이러한 메서드를 테스트할 때는 메서드가 적절히 불러졌는지 확인하는 것밖에 없다.</p><p>Testing begavior와 testing implementation이 같아지는 예시)</p><p>다음과 같이 terminalService에서 terminal list을 가져와 하나씩 <code class="language-plaintext highlighter-rouge">ContactTerminal</code> 메서드에 넣어 실행시키는 <code class="language-plaintext highlighter-rouge">FindTerminals</code> 메서드가 있다고 해보자.</p><div class="language-javascript highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="k">void</span> <span class="nc">FindTerminals</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">terminals</span> <span class="o">=</span> <span class="nx">terminalService</span><span class="p">.</span><span class="nc">FindAll</span><span class="p">();</span>
    <span class="nf">foreach </span><span class="p">(</span><span class="kd">var</span> <span class="nx">terminal</span> <span class="k">in</span> <span class="nx">terminals</span><span class="p">)</span>
        <span class="nc">ContactTerminal</span><span class="p">(</span><span class="nx">terminal</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">FindTerminals</code> 에 대한 테스트는 다음과 같다.<code class="language-plaintext highlighter-rouge"> terminalService.FIndAll()</code> 메서드의 응답으로 3개의 terminal 을 응답하도록 stub 처리하고, FindTerminals을 실행시킨다. 그리고 정확히 3번 ContactTerminal이 실행되는지 확인하는 코드이다.</p><div class="language-javascript highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="kd">var</span> <span class="nx">terminals</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">List</span><span class="o">&lt;</span><span class="nx">Terminal</span><span class="o">&gt;</span><span class="p">{</span> <span class="k">new</span> <span class="nc">Terminal</span><span class="p">(),</span> <span class="k">new</span> <span class="nc">Terminal</span><span class="p">(),</span> <span class="k">new</span> <span class="nc">Terminal</span><span class="p">()</span> <span class="p">};</span>
<span class="nx">terminalServiceMock</span>
    <span class="p">.</span><span class="nc">Setup</span><span class="p">(</span><span class="nx">f</span> <span class="o">=&gt;</span> <span class="nx">f</span><span class="p">.</span><span class="nc">FindAll</span><span class="p">())</span>
    <span class="p">.</span><span class="nc">Returns</span><span class="p">(</span><span class="nx">terminals</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">activeTerminalLocatorMock</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Mock</span><span class="o">&lt;</span><span class="nx">ActiveTerminalLocator</span><span class="o">&gt;</span><span class="p">(</span>
        <span class="nx">terminalServiceMock</span><span class="p">.</span><span class="nb">Object</span><span class="p">,</span>
        <span class="nx">networkServiceFactoryMock</span><span class="p">.</span><span class="nb">Object</span><span class="p">,</span>
        <span class="nx">backgroundWorkerFactory</span>
<span class="p">);</span>
<span class="nx">activeTerminalLocatorMock</span><span class="p">.</span><span class="nb">Object</span><span class="p">.</span><span class="nc">FindTerminals</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>

<span class="nx">activeTerminalLocatorMock</span><span class="p">.</span><span class="nc">Verify</span><span class="p">(</span>
    <span class="nx">f</span> <span class="o">=&gt;</span> <span class="nx">f</span><span class="p">.</span><span class="nc">ContactTerminal</span><span class="p">(</span><span class="nx">It</span><span class="p">.</span><span class="nx">IsAny</span><span class="o">&lt;</span><span class="nx">Terminal</span><span class="o">&gt;</span><span class="p">()),</span>
    <span class="nx">Times</span><span class="p">.</span><span class="nc">Exactly</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="p">);</span>
</pre></table></code></div></div><p>위와 같은 테스트는 구현을 검증한 예시이다. 어떤 메서드가 몇번 호출되었는지 확인하는 코드이기 때문이다. 하지만 결과를 검증하는 예시이기도 하다. ContactTerminal이 주어진 terminal만큼 실행시키는 것이 FindTerminals의 목적이고, 그것을 검증하는 코드이기 때문이다. 예를 들어 FindTerminals가 다음과 같이 변경되어도, FindTerminals의 목적은 똑같기에 때문에 테스트 코드는 여전히 유효하다.</p><div class="language-javascript highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="k">void</span> <span class="nc">FindTerminals</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">terminals</span> <span class="o">=</span> <span class="nx">terminalService</span><span class="p">.</span><span class="nc">FindAll</span><span class="p">();</span>
    <span class="nf">foreach </span><span class="p">(</span><span class="kd">var</span> <span class="nx">terminal</span> <span class="k">in</span> <span class="nx">terminals</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">using</span><span class="p">(</span><span class="kd">var</span> <span class="nx">worker</span> <span class="o">=</span> <span class="nx">workerFactory</span><span class="p">.</span><span class="nc">CreateWorker</span><span class="p">(){</span>
            <span class="nx">worker</span><span class="p">.</span><span class="nx">DoWork</span> <span class="o">+=</span> <span class="p">(</span><span class="nx">o</span><span class="p">,</span> <span class="nx">ea</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nc">ContactTerminal</span><span class="p">(</span><span class="nx">terminal</span><span class="p">);</span>	<span class="c1">// 3번 실행됨.</span>
            <span class="nx">worker</span><span class="p">.</span><span class="nc">RunWorkerAsync</span><span class="p">();</span>
         <span class="p">}</span>
     <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>이와 같이 테스트 대상의 목적을 검증하는 것과 구현을 검증하는 것이 같아지는 때가 있다. 이때는 구현이 크게 변경되어도, 목적이 달라지지 않는다면 테스트 코드는 변화하지 않는다.</p><hr /><p><strong>포스트 후기</strong></p><p>이 포스팅에서 얻은 것은 테스트 대상의 목적을 확실히하고, 그 목적을 테스트한다면 구현을 테스트하더라도 위에서 걱정했던 테스트 코드를 변경하는 문제는 나타나지 않는다는 점이다.</p><p>예시에서 봤듯이 어떤 메서드를 몇번 호출하였는지를 확인하는 것은 구현 검증이지만, 목적 자체가 ContactTerminal을 호출하는 것이었기에 테스트 코드는 변화하지 않았다.</p><p>만약 ContactTerminal를 호출하지 않는 사양으로 메서드가 변경된다면 그것은 목적이 변한 것이니 애초에 메서드를 분리해서 구현하든가, 테스트 코드도 마땅히 바꿔야하는 일이다.</p><p><br /></p><h3 id="michel---test-behavior-not-implementation"><strong><a href="https://craftsmen.nl/test-behaviour-not-implementation/">Michel - Test behavior, not implementation</a></strong></h3><p>다음과 같이 간단한 메서드가 있다고 해보자.</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Book</span><span class="o">&gt;</span> <span class="nf">getAllBooks</span><span class="o">()</span> <span class="o">{</span>
	<span class="k">return</span> <span class="n">bookRepository</span><span class="o">.</span><span class="na">getAllBooks</span><span class="o">();</span>
<span class="o">}</span>
</pre></table></code></div></div><p>이 메서드에 대한 테스트를 다음과 같이 작성할 수 있다. 이는 bookRepository의 메서드가 제대로 호출되었는지 확인하는 것이므로 구현을 테스트한 것에 속한다.</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="kd">private</span> <span class="nc">Book</span> <span class="n">lord_of_the_rings</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Book</span><span class="o">(</span><span class="s">"Lord of the rings"</span><span class="o">);</span>

<span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">reallyInterestedInWhatThisServiceIsDoing</span><span class="o">()</span> <span class="o">{</span>
	<span class="nc">BookRepository</span> <span class="n">bookRepository</span> <span class="o">=</span> <span class="n">mock</span><span class="o">(</span><span class="nc">BookRepository</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
   <span class="n">when</span><span class="o">(</span><span class="n">bookRepository</span><span class="o">.</span><span class="na">getAllBooks</span><span class="o">()).</span><span class="na">thenReturn</span><span class="o">(</span><span class="nc">Collections</span><span class="o">.</span><span class="na">singletonList</span><span class="o">(</span><span class="n">lord_of_the_rings</span><span class="o">));</span>
	<span class="nc">BookService</span> <span class="n">bookService</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BookService</span><span class="o">(</span><span class="n">bookRepository</span><span class="o">);</span>

	<span class="n">assertThat</span><span class="o">(</span><span class="n">bookService</span><span class="o">.</span><span class="na">getAllBooks</span><span class="o">(),</span> <span class="n">containsInAnyOrder</span><span class="o">(</span><span class="n">lord_of_the_rings</span><span class="o">));</span>
	<span class="n">verify</span><span class="o">(</span><span class="n">bookRepository</span><span class="o">,</span> <span class="n">times</span><span class="o">(</span><span class="mi">1</span><span class="o">)).</span><span class="na">getAllBooks</span><span class="o">();</span>
<span class="o">}</span>
</pre></table></code></div></div><p>우리는 behaviour를 테스트해야한다. 따라서 위 테스트는 아래와 같이 behaviour만 테스트하는 형태로 변경되어야한다.</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="kd">private</span> <span class="nc">Book</span> <span class="n">lord_of_the_rings</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Book</span><span class="o">(</span><span class="s">"Lord of the rings"</span><span class="o">);</span>

<span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">shouldGetAllBooks</span><span class="o">()</span> <span class="o">{</span>
	<span class="nc">BookRepository</span> <span class="n">bookRepository</span> <span class="o">=</span> <span class="n">mock</span><span class="o">(</span><span class="nc">BookRepository</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
   <span class="n">when</span><span class="o">(</span><span class="n">bookRepository</span><span class="o">.</span><span class="na">getAllBooks</span><span class="o">()).</span><span class="na">thenReturn</span><span class="o">(</span><span class="nc">Collections</span><span class="o">.</span><span class="na">singletonList</span><span class="o">(</span><span class="n">lord_of_the_rings</span><span class="o">));</span>
	<span class="nc">BookService</span> <span class="n">bookService</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BookService</span><span class="o">(</span><span class="n">bookRepository</span><span class="o">);</span>

	<span class="n">assertThat</span><span class="o">(</span><span class="n">bookService</span><span class="o">.</span><span class="na">getAllBooks</span><span class="o">(),</span> <span class="n">containsInAnyOrder</span><span class="o">(</span><span class="n">lord_of_the_rings</span><span class="o">));</span>
<span class="o">}</span>
</pre></table></code></div></div><p>물론 테스트가 돌아가게 하기위해 bookRepository은 mock 객체이고, when을 사용하여 behaviour을 정의하고 합치는 <code class="language-plaintext highlighter-rouge">collaborator</code>는 필요하다.</p><p><code class="language-plaintext highlighter-rouge">Verify behaviour</code>는 <code class="language-plaintext highlighter-rouge">mutation</code>에서도 적용된다. 물론 그러한 메서드는 void 타입을 반환을 할 수 있다. 유일한 차이는 결과가 아래에서 나온다는 점이다.</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kt">void</span> <span class="nf">createBook</span><span class="o">(</span><span class="nc">Book</span> <span class="n">book</span><span class="o">)</span> <span class="o">{</span>
	<span class="n">bookRepository</span><span class="o">.</span><span class="na">createBook</span><span class="o">(</span><span class="n">book</span><span class="o">);</span>
<span class="o">}</span>
<span class="o">...</span>
<span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">insertBook</span><span class="o">()</span> <span class="o">{</span>
	<span class="nc">BookRepository</span> <span class="n">bookRepository</span> <span class="o">=</span> <span class="n">mock</span><span class="o">(</span><span class="nc">BookRepository</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
	<span class="nc">BookService</span> <span class="n">bookService</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BookService</span><span class="o">(</span><span class="n">bookRepository</span><span class="o">);</span>
	<span class="nc">Book</span> <span class="n">the_dark_tower</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Book</span><span class="o">(</span><span class="s">"The Dark Tower"</span><span class="o">);</span>
	<span class="n">bookService</span><span class="o">.</span><span class="na">createBook</span><span class="o">(</span><span class="n">the_dark_tower</span><span class="o">);</span>

	<span class="n">verify</span><span class="o">(</span><span class="n">bookRepository</span><span class="o">,</span> <span class="n">times</span><span class="o">(</span><span class="mi">1</span><span class="o">)).</span><span class="na">createBook</span><span class="o">(</span><span class="n">the_dark_tower</span><span class="o">);</span>
<span class="o">}</span>
</pre></table></code></div></div><p>mutation의 결과를 반환하는 경우도 있다. 그럴 경우 반환값과 호출 여부를 모두 확인해야한다. 하지만 보통 이런 메서드는 사이드 이펙트를 부르는 안티패턴이고, 두 개의 메서드로 분리되어야한다.</p><hr /><p><strong>포스트 후기</strong></p><p>첫번째 포스트와 비슷하게 다른 메서드 호출이 중요한 메서드의 테스트는 호출여부를 확인하였다.</p><p><br /></p><h3 id="unit-testing-behaviours-without-coupling-to-implementation-details"><strong><a href="https://softwareengineering.stackexchange.com/questions/234024/unit-testing-behaviours-without-coupling-to-implementation-details">Unit testing behaviours without coupling to implementation details</a></strong></h3><p>Q : <code class="language-plaintext highlighter-rouge">save X to some data source</code>와 같이 일반적인 <code class="language-plaintext highlighter-rouge">service-repotisoty</code>구조에서 구현을 함께 테스트하지 않고 어떻게 테스트를 하는가?</p><p>A1)</p><p><code class="language-plaintext highlighter-rouge">save X to some data source</code> 과 같은 경우는 외부 의존성과 통신하는 경우이므로, 특정한 메서드가 제대로 호출되었는지 테스트 해야하는 경우에 속한다. <strong>테스트해야할 behaviour가 통신이 예상대로 이뤄졌는가</strong>이기 때문이다.</p><p>어플리케이션과 외부 의존성 사이의 인터페이스는 구현상세가 아니고 시스템 아키텍쳐 정의이다. 변경될 일이 적다는 의미이다. 따라서 repository 인터페이스를 테스트하는 것은 그리 많은 문제를 내지 않는다.(만약 문제를 많이 내면, 인터페이스가 어플리케이션의 역할을 빼았은 경우에 속한다.)</p><p>UI, 데이터베이스, 외부 서비스를 제외한 어플리케이션의 비즈니스 로직만이 테스트와 구현상세를 분리해야하는 부분이다.</p><p>A2)</p><ul><li>모든 인터페이스는 input, output, collaborator(like database) 와 함께 구성된다.<li>input 인터페이스는 테스트하라 : 메서드를 부르고, 반환값을 assert하라<li>output 인터페이스는 mock 하라 : 예상되는 메서드가 올바른 값으로 호출되었는지 확인하라<li>collaborator는 fake하라 : 간단하지만 동작하는 구현을 붙여라</ul><p>database는 일반적으로 collaborator다. mock되기보단 fake를 붙이는 게 좋다. 손으로 구현하긴 어렵지만, 사용할 수 있는 도구들이 있다. 로그처럼 한번 써지고 다시는 읽히지 않은 database는 output이므로 mock되어야한다.</p><p>Input-output-collaborator에 대해 자세히</p><ul><li>interface는 외부 세계(db, socket, http 등)과 통하는 port를 감싸고 있다.<li>output interface : exception을 제외한 반환값을 내지 않고, port를 통해 외부 세계로 나가는 인터페이스이다<li>input interface : 반환 값을 내며, 외부로 나가지 않는 인터페이스이다<li>Collaborator : input, output 둘 다한다</ul><hr /><p><strong>후기</strong></p><p>답변 1에서는 service의 behaviour가 repository와 통신하는 것이므로 메서드 호출 여부를 확인해야하며, repository는 제대로 설계되었다면 변경될 일이 적으므로 괜찮다는 말이다.</p><p>답변 2는 input-output-collaborator로 인터페이스를 나눠서 repository와 같은 collaborator는 가짜 구현을 붙여 결과를 테스트 하라고 하였다.</p><p>첫번째 답변에서는 repository를 크게 변경하여 테스트가 너무 많이 깨진다면 애초에 설계가 잘못된 것이라는 점을 알았다. 두번째 답변에서는 가짜 데이터베이스를 붙여 결과를 확인하는 것도 가능하는 것을 알았다.</p><p><br /></p><h2 id="결론"><strong>결론</strong></h2><p>세가지 글을 읽고 나니 구현 검증 없이 테스트를 어떻게 해야하는 것인지 어느정도 감이 잡혔다. 다음과 같은 유형으로 정리할 수 있을 거 같다</p><ul><li><p>주어진 input에 올바른 output을 반환하는 것이 목적인 경우</p><p>-&gt; input 값에 따른 output이 올바른지 테스트</p><li><p>다른 메서드를 올바르게 호출하는 것이 목적인 경우</p><ul><li>호출해야하는 메서드를 올바른 값으로 호출하였는지 테스트 (행동 검증 == 구현 검증)<li>이때 호출해야하는 것이 collaborator 인터페이스라면, fake 구현을 붙일 수도 있다.</ul></ul><p>중요한 것은 테스트 대상의 목적을 명확히 하는 것이다. 그 후 그 목적을 테스트한다면, 구현을 검증하더라도 행동을 검증하는 것이 된다.</p><p>그리고 좀 더 세부적으로 일반적인 <code class="language-plaintext highlighter-rouge">service-repository</code> 구조에서 repository가 제대로 호출되었는지 확인하는 것은 구현을 테스트하는 것이 아니라고 볼수도 있다. repository는 외부 데이터베이스의 인터페이스이므로 구현보다는 시스템 아키텍쳐에 가깝기 때문이다. 따라서 respository의 변경은 일반적으로 테스트를 깨트리지 않고, 만약 테스트를 너무 많이 깨트린다면 repository 설계가 잘못된 것이기에 마땅히 테스트를 수정해야한다.</p><p><code class="language-plaintext highlighter-rouge">service-repository</code> 구조에서는 repository를 제대로 호출하는 것으로 검증할수도 있지만, 만약 정말로 데이터가 제대로 저장되는지 확인하고 싶다면 테스트용 DB를 사용하는 방법도 있다.</p><p><br /></p><h2 id="주의할-점">주의할 점</h2><p>테스트를 작성하는 것은 완벽히 하기 위해 하는 것이 아니다. <strong>코드를 조금 더 좋게</strong> 하기 위해 하는 것이다. 따라서 좋은 테스트를 작성하도록 노력은 하되 너무 집착하여 완벽한 테스트를 작성하고자 하진 않아도 된다.</p><p><br /></p><h2 id="출처">출처</h2><ul><li>https://jojoldu.tistory.com/614<li>https://understandlegacycode.com/blog/is-it-ok-to-change-code-for-testing-sake/<li>https://launchscout.com/blog/testing-behavior-vs-testing-implementation<li>https://craftsmen.nl/test-behaviour-not-implementation/<li>https://softwareengineering.stackexchange.com/questions/234024/unit-testing-behaviours-without-coupling-to-implementation-details</ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/study/'>study</a>, <a href='/categories/design-pattern/'>design pattern</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/design/" class="post-tag no-text-decoration" >design</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=유닛테스트 구현 검증이란? - 디피의 개발일지&url=https://seongil-shin.github.io/posts/design-pattern-%EC%9C%A0%EB%8B%9B%ED%85%8C%EC%8A%A4%ED%8A%B8%EC%97%90%EC%84%9C-%EA%B5%AC%ED%98%84-%EA%B2%80%EC%A6%9D%EC%9D%B4%EB%9E%80/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=유닛테스트 구현 검증이란? - 디피의 개발일지&u=https://seongil-shin.github.io/posts/design-pattern-%EC%9C%A0%EB%8B%9B%ED%85%8C%EC%8A%A4%ED%8A%B8%EC%97%90%EC%84%9C-%EA%B5%AC%ED%98%84-%EA%B2%80%EC%A6%9D%EC%9D%B4%EB%9E%80/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=유닛테스트 구현 검증이란? - 디피의 개발일지&url=https://seongil-shin.github.io/posts/design-pattern-%EC%9C%A0%EB%8B%9B%ED%85%8C%EC%8A%A4%ED%8A%B8%EC%97%90%EC%84%9C-%EA%B5%AC%ED%98%84-%EA%B2%80%EC%A6%9D%EC%9D%B4%EB%9E%80/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/You-don't-know-JS-Yet-1%EC%9E%A5-%EC%9E%90%EB%B0%94%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8/">You don't know JS Yet - 1장 자바스크립트</a><li><a href="/posts/why-nextjs-sucks/">why-nextjs-sucks</a><li><a href="/posts/the-state-of-es5-on-the-web/">the state of es5 on the web</a><li><a href="/posts/%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%A8%B8%EC%9D%98-%EB%87%8C-3%EC%9E%A5-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D-%EB%AC%B8%EB%B2%95-%EB%B9%A0%EB%A5%B4%EA%B2%8C-%EB%B0%B0%EC%9A%B0%EA%B8%B0/">프로그래머의 뇌 3장 프로그래밍 문법 빠르게 배우기</a><li><a href="/posts/%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%A8%B8%EC%9D%98-%EB%87%8C-4%EC%9E%A5-%EB%B3%B5%EC%9E%A1%ED%95%9C-%EC%BD%94%EB%93%9C-%EC%9D%BD%EB%8A%94-%EB%B0%A9%EB%B2%95/">프로그래머의 뇌 4장 복잡한 코드 읽는 방법</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/study/">#study</a> <a class="post-tag" href="/tags/spring/">spring</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/next-js/">next.js</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/db/">db</a> <a class="post-tag" href="/tags/react/">react</a> <a class="post-tag" href="/tags/kubernetes/">kubernetes</a> <a class="post-tag" href="/tags/architecture/">architecture</a> <a class="post-tag" href="/tags/java/">java</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/design-pattern-%EC%A2%8B%EC%9D%80-%EB%A1%9C%EA%B9%85%EC%9D%84-%EC%9C%84%ED%95%B4-%EC%95%8C%EC%95%84%EC%95%BC%ED%95%A0-%EA%B2%83/"><div class="card-body"> <span class="timeago small" > Nov 17, 2022 <i class="unloaded">2022-11-17T15:23:26+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>좋은 로깅을 위해 알아야할 13가지</h3><div class="text-muted small"><p> 이 글은 Logging Best Pratices : The 13 You Should Know를 기반으로 요약, 학습한 글입니다. 좋은 로깅을 위해 알아야할 13가지 Don’t write logs by yourself printf을 사용하거나 파일에 직접 입력하지마라. 로깅을 위한 표준 라이브러리를 사용하라. 표준 라이브러리를 사용할 때 장점...</p></div></div></a></div><div class="card"> <a href="/posts/oop/"><div class="card-body"> <span class="timeago small" > Jan 13, 2022 <i class="unloaded">2022-01-13T14:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Object Oriented Programming</h3><div class="text-muted small"><p> OOP는 너무 거대한 개념이라 다 다루지는 못하지만 간단히만 알아보자 간단한 설명 OOP : 중심적 프로그래밍 패러다임. 현실 세계의 사물들을 객체라고 보고, 그 객체로부터 개발하고자 하는 애플리케이션에 필요한 특징들을 뽑아와 프로그래밍하는 것(추상화) 장점 OOP로 작성한 코드는 재사용성이 높다. ...</p></div></div></a></div><div class="card"> <a href="/posts/%ED%95%A8%EC%88%98%ED%98%95-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D/"><div class="card-body"> <span class="timeago small" > Jan 14, 2022 <i class="unloaded">2022-01-14T14:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>함수형 프로그래밍</h3><div class="text-muted small"><p> 부수 효과가 없는 순수함수를 1급 객체로 간주하여 파라미터로 넘기거나 반환값으로 사용하는 것을 가능하도록 하여, 참조 투명성을 지키도록 하는 프로그래밍 패러다임 순수 함수형 프로그래밍만으로 개발을 하기에는 무리가 있다. 따라서 적절히 조절해가면서 개발을 해나가자. 요약 함수형 프로그래밍의 가장 큰 특징 두 가지 immutable data ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/web-keep-alive/" class="btn btn-outline-primary" prompt="Older"><p>Keep-Alive</p></a> <a href="/posts/spring-Validation/" class="btn btn-outline-primary" prompt="Newer"><p>Spring 파라미터 Validation</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="text-center text-muted small pb-5"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> const options = { scriptUrl: '//.disqus.com/embed.js', disqusConfig: function() { this.page.title = '유닛테스트 구현 검증이란?'; this.page.url = 'https://seongil-shin.github.io/posts/design-pattern-%EC%9C%A0%EB%8B%9B%ED%85%8C%EC%8A%A4%ED%8A%B8%EC%97%90%EC%84%9C-%EA%B5%AC%ED%98%84-%EA%B2%80%EC%A6%9D%EC%9D%B4%EB%9E%80/'; this.page.identifier = '/posts/design-pattern-%EC%9C%A0%EB%8B%9B%ED%85%8C%EC%8A%A4%ED%8A%B8%EC%97%90%EC%84%9C-%EA%B5%AC%ED%98%84-%EA%B2%80%EC%A6%9D%EC%9D%B4%EB%9E%80/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://github.com/Seongil-Shin">ShinSeongil</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/study/">#study</a> <a class="post-tag" href="/tags/spring/">spring</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/next-js/">next.js</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/db/">db</a> <a class="post-tag" href="/tags/react/">react</a> <a class="post-tag" href="/tags/kubernetes/">kubernetes</a> <a class="post-tag" href="/tags/architecture/">architecture</a> <a class="post-tag" href="/tags/java/">java</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://seongil-shin.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
