<!DOCTYPE html><html lang="ko" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="container 안에서 pm2로 next.js 앱 실행하기" /><meta name="author" content="신성일" /><meta property="og:locale" content="ko" /><meta name="description" content="next.js는 기본적으로 node.js runtime에서 작동된다. 하지만 node.js 는 싱글 스레드 기반이고, 따라서 트래픽이 많은 환경에서 multi-core를 사용하여 node.js 앱을 구동하기 위해선 다음과 같은 방법이 있다." /><meta property="og:description" content="next.js는 기본적으로 node.js runtime에서 작동된다. 하지만 node.js 는 싱글 스레드 기반이고, 따라서 트래픽이 많은 환경에서 multi-core를 사용하여 node.js 앱을 구동하기 위해선 다음과 같은 방법이 있다." /><link rel="canonical" href="https://seongil-shin.github.io/posts/next.js-container-%EC%95%88%EC%97%90%EC%84%9C-pm2%EB%A1%9C-next.js-%EC%95%B1-%EC%8B%A4%ED%96%89%ED%95%98%EA%B8%B0/" /><meta property="og:url" content="https://seongil-shin.github.io/posts/next.js-container-%EC%95%88%EC%97%90%EC%84%9C-pm2%EB%A1%9C-next.js-%EC%95%B1-%EC%8B%A4%ED%96%89%ED%95%98%EA%B8%B0/" /><meta property="og:site_name" content="디피의 개발일지" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-01-25T23:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="container 안에서 pm2로 next.js 앱 실행하기" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"신성일"},"dateModified":"2023-05-30T21:53:32+09:00","datePublished":"2023-01-25T23:00:00+09:00","description":"next.js는 기본적으로 node.js runtime에서 작동된다. 하지만 node.js 는 싱글 스레드 기반이고, 따라서 트래픽이 많은 환경에서 multi-core를 사용하여 node.js 앱을 구동하기 위해선 다음과 같은 방법이 있다.","headline":"container 안에서 pm2로 next.js 앱 실행하기","mainEntityOfPage":{"@type":"WebPage","@id":"https://seongil-shin.github.io/posts/next.js-container-%EC%95%88%EC%97%90%EC%84%9C-pm2%EB%A1%9C-next.js-%EC%95%B1-%EC%8B%A4%ED%96%89%ED%95%98%EA%B8%B0/"},"url":"https://seongil-shin.github.io/posts/next.js-container-%EC%95%88%EC%97%90%EC%84%9C-pm2%EB%A1%9C-next.js-%EC%95%B1-%EC%8B%A4%ED%96%89%ED%95%98%EA%B8%B0/"}</script><title>container 안에서 pm2로 next.js 앱 실행하기 | 디피의 개발일지</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-HC9W0NGRV0"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-HC9W0NGRV0'); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/profile.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">디피의 개발일지</a></div><div class="site-subtitle font-italic">개인 학습 및 프로젝트 기록</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/Seongil-Shin" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['callmeshin75','gmail.com'].join('@')" aria-label="email" class="order-4" > <i class="fas fa-envelope"></i> </a> <a href="https://www.linkedin.com/in/%EC%84%B1%EC%9D%BC-%EC%8B%A0-a9411b237/" aria-label="linkedin" class="order-5" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>container 안에서 pm2로 next.js 앱 실행하기</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>container 안에서 pm2로 next.js 앱 실행하기</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> 신성일 </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Wed, Jan 25, 2023, 11:00 PM +0900" prep="on" > Jan 25, 2023 <i class="unloaded">2023-01-25T23:00:00+09:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Tue, May 30, 2023, 9:53 PM +0900" prefix="Updated " > May 30, 2023 <i class="unloaded">2023-05-30T21:53:32+09:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="954 words">5 min</span></div></div><div class="post-content"><p>next.js는 기본적으로 <strong>node.js runtime</strong>에서 작동된다. 하지만 node.js 는 싱글 스레드 기반이고, 따라서 트래픽이 많은 환경에서 multi-core를 사용하여 node.js 앱을 구동하기 위해선 다음과 같은 방법이 있다.</p><ul><li>worker thread<li>child process<li>cluster</ul><p>필자는 next.js에서 가장 사용하기 편한 방식인 cluster를 선택하였고, 편리하게 하기위해 <code class="language-plaintext highlighter-rouge">pm2</code>의 <code class="language-plaintext highlighter-rouge">cluster</code> 모드를 사용하기로 결정하였다. 환경은 kubernetes 환경으로 하나의 pod에 2~3개의 next.js 인스턴스를 pm2의 cluster 모드로 관리하고자 하였다.</p><p>따라서 가이드를 따라 다음과 같이 Dockerfile과 pm2 설정파일을 작성하였다.</p><div class="language-js highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="c1">// ./ecosystem.config.js</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">apps</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">next-app</span><span class="dl">"</span><span class="p">,</span>
      <span class="na">script</span><span class="p">:</span> <span class="dl">"</span><span class="s2">node_modules/next/dist/bin/next</span><span class="dl">"</span><span class="p">,</span>
      <span class="na">args</span><span class="p">:</span> <span class="dl">"</span><span class="s2">start --port 80</span><span class="dl">"</span><span class="p">,</span>
      <span class="na">instances</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
      <span class="na">exec_mode</span><span class="p">:</span> <span class="dl">"</span><span class="s2">cluster</span><span class="dl">"</span><span class="p">,</span>
    <span class="p">},</span>
  <span class="p">],</span>
<span class="p">};</span>
</pre></table></code></div></div><div class="language-json highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="err">//</span><span class="w"> </span><span class="err">package.json</span><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="err">...</span><span class="w">
  </span><span class="nl">"script"</span><span class="p">:{</span><span class="w">
    </span><span class="err">...</span><span class="w">
    </span><span class="nl">"start-pm2:dev"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pm2 start ecosystem.config.js"</span><span class="p">,</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><div class="language-dockerfile highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="c"># Stage 0 </span>
<span class="k">FROM</span><span class="w"> </span><span class="s">node</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s">nextjs-builder</span>

<span class="c"># next.js 빌드</span>
<span class="k">WORKDIR</span><span class="s"> /home/deploy/next</span>
<span class="k">COPY</span><span class="s"> ./package.json ./package.json</span>
<span class="k">COPY</span><span class="s"> ./package-lock.json ./package-lock.json</span>
<span class="k">RUN  </span>npm ci
<span class="k">COPY</span><span class="s"> ./ecosystem.config.js ./ecosystem.config.js</span>
<span class="k">COPY</span><span class="s"> ./.env ./.env</span>
<span class="k">COPY</span><span class="s"> ./next.config.js ./next.config.js</span>
<span class="k">COPY</span><span class="s"> ./public ./public</span>
<span class="k">COPY</span><span class="s"> ./src ./src</span>
<span class="k">RUN </span>npm run build

<span class="c"># 프로젝트 실행</span>
<span class="k">ENTRYPOINT</span><span class="s"> ["npm", "run", "start-pm2:dev"]</span>
</pre></table></code></div></div><p>하지만 막상 도커 이미지를 빌드하고, 컨테이너를 실행하니 pm2가 실행되자마자 바로 컨테이너가 종료되었다. 그 후로도 다른 문제가 계속 발생하였는데, 차례대로 해결한 과정을 정리하였다.</p><p><br /></p><h2 id="pm2-runtime-사용">pm2-runtime 사용</h2><p>pm2를 container에서 실행하려면 <code class="language-plaintext highlighter-rouge">pm2 start</code>가 아닌 <code class="language-plaintext highlighter-rouge">pm2-runtime start</code>를 사용해야한다. <a href="https://pm2.keymetrics.io/docs/usage/docker-pm2-nodejs/">공식문서</a> 따라서 <code class="language-plaintext highlighter-rouge">package.json</code>의 명령문을 다음과 같이 바꿔야한다.</p><div class="language-json highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="err">...</span><span class="w">
  </span><span class="nl">"script"</span><span class="p">:{</span><span class="w">
    </span><span class="err">...</span><span class="w">
    </span><span class="nl">"start-pm2:dev"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pm2-runtime start ecosystem.config.js"</span><span class="p">,</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>하지만 컨테이너를 실행하니 다음과 같은 오류가 나타났다.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>Error: Could not find a production build in the '/home/deploy/next/ecosystem.config.js/.next' directory. Try building your app with 'next build' before starting the production se
rver. https://err.sh/vercel/next.js/production-start-no-build-id
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">/home/deploy/next/ecosystem.config.js/.next</code>라는 경로에 빌드 파일이 없다는 말이다. 단순히 빌드오류라고 생각할 수 있지만 뭔가 경로가 이상하다. <code class="language-plaintext highlighter-rouge">ecosystem.config.js</code>는 파일인데 이 파일을 마치 디렉터리처럼 인식하고, 이 파일의 하위에서 빌드파일을 찾는다.</p><p>현재 프로젝트의 파일 구조는 다음과 같다.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>-- next
|-- .next (빌드파일)
|-- package.json
|-- ecosystem.config.js
|-- (...기타 소스파일들)
</pre></table></code></div></div><p>Dockerfile에서 마지막 WORKDIR은 <code class="language-plaintext highlighter-rouge">/home/deploy/next</code>이므로, 명령어를 실행한 위치는 <code class="language-plaintext highlighter-rouge">/home/deploy/next</code>이다. 따라서 <code class="language-plaintext highlighter-rouge">home/deploy/next/.next</code>로 빌드파일의 경로를 설정해야하나, <code class="language-plaintext highlighter-rouge">ecosystem.config.js</code>로 경로를 설정한 것을 모도 pm2의 문제가 있다고 생각하여 찾아보았다.</p><p><br /></p><h2 id="pm2-list">pm2 list</h2><p>검색을 한 결과 나하고 비슷한 문제를 겪은 사람을 발견하였다. <a href="https://stackoverflow.com/questions/66296203/azure-app-service-linux-next-js-app-pm2-not-possible-to-set-cluster-mode">링크</a> 이 사람이 스스로 찾은 답은 다음과 같다.</p><blockquote><p>Adding command pm2 list before pm2-runtime solves the issue, I suppose that the command pm2 list initializes the pm2 and sets the proper path for pm2-runtime.</p></blockquote><p>즉, pm2-runtime을 실행하기 전에 먼저 <code class="language-plaintext highlighter-rouge">pm2 list</code>를 실행하라는 뜻이다. 그럼 pm2 가 초기화되어 올바른 경로를 설정한다고 한다. 따라서 package.json을 다음과 같이 변경하였다.</p><div class="language-json highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="err">...</span><span class="w">
  </span><span class="nl">"script"</span><span class="p">:{</span><span class="w">
    </span><span class="err">...</span><span class="w">
    </span><span class="nl">"start-pm2:dev"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pm2 list &amp;&amp; pm2-runtime start ecosystem.config.js"</span><span class="p">,</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>이후 컨테이너를 실행하니 제대로 실행되었다. status를 확인해보니 다음과 같이 나왔다.</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>ready - started server on 0.0.0.0:80, url: http://localhost:80
info  - Loaded <span class="nb">env </span>from /home/develop/deploy/next/.env
ready - started server on 0.0.0.0:80, url: http://localhost:80
info  - Loaded <span class="nb">env </span>from /home/develop/deploy/next/.env
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/study/'>study</a>, <a href='/categories/next-js/'>next.js</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/kubernetes/" class="post-tag no-text-decoration" >kubernetes</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=container 안에서 pm2로 next.js 앱 실행하기 - 디피의 개발일지&url=https://seongil-shin.github.io/posts/next.js-container-%EC%95%88%EC%97%90%EC%84%9C-pm2%EB%A1%9C-next.js-%EC%95%B1-%EC%8B%A4%ED%96%89%ED%95%98%EA%B8%B0/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=container 안에서 pm2로 next.js 앱 실행하기 - 디피의 개발일지&u=https://seongil-shin.github.io/posts/next.js-container-%EC%95%88%EC%97%90%EC%84%9C-pm2%EB%A1%9C-next.js-%EC%95%B1-%EC%8B%A4%ED%96%89%ED%95%98%EA%B8%B0/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=container 안에서 pm2로 next.js 앱 실행하기 - 디피의 개발일지&url=https://seongil-shin.github.io/posts/next.js-container-%EC%95%88%EC%97%90%EC%84%9C-pm2%EB%A1%9C-next.js-%EC%95%B1-%EC%8B%A4%ED%96%89%ED%95%98%EA%B8%B0/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/You-don't-know-JS-Yet-1%EC%9E%A5-%EC%9E%90%EB%B0%94%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8/">You don't know JS Yet - 1장 자바스크립트</a><li><a href="/posts/why-nextjs-sucks/">why-nextjs-sucks</a><li><a href="/posts/the-state-of-es5-on-the-web/">the state of es5 on the web</a><li><a href="/posts/%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%A8%B8%EC%9D%98-%EB%87%8C-3%EC%9E%A5-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D-%EB%AC%B8%EB%B2%95-%EB%B9%A0%EB%A5%B4%EA%B2%8C-%EB%B0%B0%EC%9A%B0%EA%B8%B0/">프로그래머의 뇌 3장 프로그래밍 문법 빠르게 배우기</a><li><a href="/posts/%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%A8%B8%EC%9D%98-%EB%87%8C-4%EC%9E%A5-%EB%B3%B5%EC%9E%A1%ED%95%9C-%EC%BD%94%EB%93%9C-%EC%9D%BD%EB%8A%94-%EB%B0%A9%EB%B2%95/">프로그래머의 뇌 4장 복잡한 코드 읽는 방법</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/study/">#study</a> <a class="post-tag" href="/tags/spring/">spring</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/next-js/">next.js</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/db/">db</a> <a class="post-tag" href="/tags/react/">react</a> <a class="post-tag" href="/tags/kubernetes/">kubernetes</a> <a class="post-tag" href="/tags/architecture/">architecture</a> <a class="post-tag" href="/tags/java/">java</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/devops-kubernetes/"><div class="card-body"> <span class="timeago small" > Nov 30, 2022 <i class="unloaded">2022-11-30T18:19:26+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>kubernetes</h3><div class="text-muted small"><p> 이 포스트는 subicura 님의 kubenetes 게시글을 읽으며 요약/기록한 게시글입니다. Kubenetes 쿠버네티스(kubenetes, k8s)는 도커 컨테이너를 쉽고 빠르게 배포/확장하고 관리를 자동화해주는 오픈소스 플랫폼이다. 단순한 컨테이너 플랫폼이 아닌 마이크로 서비스, 클라우드 플랫폼을 지향하고 컨테이너로 이루어진 것들을 손쉽게 담...</p></div></div></a></div><div class="card"> <a href="/posts/devops-kubenetes-%EC%8B%A4%EC%8A%B5/"><div class="card-body"> <span class="timeago small" > Nov 30, 2022 <i class="unloaded">2022-11-30T18:29:26+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>kubernetes 실습</h3><div class="text-muted small"><p> 이 포스트는 subicura 님의 kubenetes 안내서을 읽으며 요약/기록한 게시글입니다. Kubenetes 실습 Pod 생성하기 YAML로 설정파일 작성하여 생성하기 apiVersion: v1 kind: Pod metadata: name: echo labels: app: echo spec: containers: -...</p></div></div></a></div><div class="card"> <a href="/posts/devops-ingress/"><div class="card-body"> <span class="timeago small" > Dec 15, 2022 <i class="unloaded">2022-12-15T19:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>쿠버네티스 Ingress</h3><div class="text-muted small"><p> 쿠버네티스 Ingress ingress는 일반적으로 외부로부터 서버 내부로 유입되는 네트워크 트래픽을 뜻한다. 쿠버네티스에서는 ingress라는 리소스 오브젝트가 존재한다. 쿠버네티스의 ingress는 외부에서 쿠버네티스 클러스터 내부로 들어오는 http, https 요청을 어떻게 처리할지 정의한다. 즉, 외부에서 쿠버네티스에서 실행 중인 depl...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/next.js-data-fetching/" class="btn btn-outline-primary" prompt="Older"><p>next.js - data fetching</p></a> <a href="/posts/next.js-next-image-%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8/" class="btn btn-outline-primary" prompt="Newer"><p>next/image 컴포넌트</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="text-center text-muted small pb-5"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> const options = { scriptUrl: '//.disqus.com/embed.js', disqusConfig: function() { this.page.title = 'container 안에서 pm2로 next.js 앱 실행하기'; this.page.url = 'https://seongil-shin.github.io/posts/next.js-container-%EC%95%88%EC%97%90%EC%84%9C-pm2%EB%A1%9C-next.js-%EC%95%B1-%EC%8B%A4%ED%96%89%ED%95%98%EA%B8%B0/'; this.page.identifier = '/posts/next.js-container-%EC%95%88%EC%97%90%EC%84%9C-pm2%EB%A1%9C-next.js-%EC%95%B1-%EC%8B%A4%ED%96%89%ED%95%98%EA%B8%B0/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://github.com/Seongil-Shin">ShinSeongil</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/study/">#study</a> <a class="post-tag" href="/tags/spring/">spring</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/next-js/">next.js</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/db/">db</a> <a class="post-tag" href="/tags/react/">react</a> <a class="post-tag" href="/tags/kubernetes/">kubernetes</a> <a class="post-tag" href="/tags/architecture/">architecture</a> <a class="post-tag" href="/tags/java/">java</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://seongil-shin.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
